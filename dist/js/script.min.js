import{config,isFeatureEnabled}from"./config.js";import{initNavigation}from"./navigation.js";import{initAnimations}from"./animations.js";import{initCookieConsent}from"./cookies.js";import{initForms}from"./forms.js";import{initUI}from"./ui.js";import{initLightbox}from"./lightbox.js";import{initNewsletter}from"./newsletter.js";let isAppInitialized=false;async function initApp(){if(isAppInitialized){console.warn("App already initialized");return}console.log("%c\uD83D\uDC3E Smarter Dog Website Loading...","font-size: 16px; color: #e76f51; font-weight: bold;");console.log("Version: 2.0.0");console.log("Environment:",getEnvironment());try{await waitForDOM();await initializeModules();isAppInitialized=true;console.log("%c\u2713 All modules initialized successfully","color: #14b8a6; font-weight: bold;");console.log("%c\uD83D\uDC3E Smarter Dog Website Ready!","font-size: 16px; color: #e76f51; font-weight: bold;");logFeatureFlags()}catch(error){console.error("Fatal error during app initialization:",error)}}async function initializeModules(){const modules=[{name:"Navigation",fn:initNavigation,critical:true},{name:"Animations",fn:initAnimations,critical:false},{name:"Cookie Consent",fn:initCookieConsent,critical:false},{name:"Forms",fn:initForms,critical:false},{name:"Newsletter",fn:initNewsletter,critical:false},{name:"UI",fn:initUI,critical:false},{name:"Lightbox",fn:initLightbox,critical:false}];for(const module of modules){try{console.log(`Initializing ${module.name}...`);await module.fn();console.log(`✓ ${module.name} initialized`)}catch(error){console.error(`✕ Failed to initialize ${module.name}:`,error);if(module.critical){throw new Error(`Critical module ${module.name} failed to initialize`)}}}}function waitForDOM(){return new Promise(resolve=>{if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",resolve,{once:true})}else{resolve()}})}function getEnvironment(){const hostname=window.location.hostname;if(hostname==="localhost"||hostname==="127.0.0.1"){return"development"}else if(hostname.includes("staging")||hostname.includes("test")){return"staging"}else{return"production"}}function logFeatureFlags(){console.group("Feature Flags");Object.entries(config.features).forEach(([feature,enabled])=>{const icon=enabled?"\u2713":"\u2715";const color=enabled?"color: #14b8a6":"color: #888";console.log(`%c${icon} ${feature}`,color)});console.groupEnd()}function handleGlobalError(event){console.error("Global error caught:",{message:event.message,filename:event.filename,lineno:event.lineno,colno:event.colno,error:event.error});if(window.gtag){window.gtag("event","exception",{description:event.message,fatal:false})}}function handleUnhandledRejection(event){console.error("Unhandled promise rejection:",event.reason);if(window.gtag){window.gtag("event","exception",{description:`Unhandled rejection: ${event.reason}`,fatal:false})}}function setupErrorHandlers(){window.addEventListener("error",handleGlobalError);window.addEventListener("unhandledrejection",handleUnhandledRejection)}function monitorPerformance(){if(!window.performance||!window.performance.timing){return}window.addEventListener("load",()=>{setTimeout(()=>{const timing=performance.timing;const loadTime=timing.loadEventEnd-timing.navigationStart;const domReadyTime=timing.domContentLoadedEventEnd-timing.navigationStart;const renderTime=timing.domComplete-timing.domLoading;console.group("Performance Metrics");console.log(`Total Load Time: ${loadTime}ms`);console.log(`DOM Ready Time: ${domReadyTime}ms`);console.log(`Render Time: ${renderTime}ms`);console.groupEnd();if(window.gtag){window.gtag("event","timing_complete",{name:"load",value:loadTime})}},0)})}function checkBrowserCompatibility(){const requiredFeatures=["querySelector","addEventListener","classList","localStorage","fetch","Promise"];const unsupportedFeatures=requiredFeatures.filter(feature=>{if(feature==="fetch")return!window.fetch;if(feature==="Promise")return!window.Promise;if(feature==="localStorage")return!window.localStorage;return!document[feature]});if(unsupportedFeatures.length>0){console.warn("Browser missing required features:",unsupportedFeatures);showBrowserWarning();return false}return true}function showBrowserWarning(){const warningHTML=`
    <div style="
      background: #f4a261;
      color: #264653;
      padding: 1rem;
      text-align: center;
      font-family: sans-serif;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 99999;
    ">
      <strong>Browser Not Fully Supported</strong> -
      Some features may not work correctly. Please consider updating your browser.
    </div>
  `;document.body.insertAdjacentHTML("afterbegin",warningHTML)}function exposeDebugUtilities(){if(getEnvironment()!=="production"){window.smarterDog={config,version:"2.0.0",modules:{navigation:()=>import("./navigation.js"),animations:()=>import("./animations.js"),cookies:()=>import("./cookies.js"),forms:()=>import("./forms.js")},reinit:()=>{isAppInitialized=false;initApp()}};console.log("Debug utilities available at window.smarterDog")}}setupErrorHandlers();checkBrowserCompatibility();monitorPerformance();exposeDebugUtilities();initApp();export default{initApp,getEnvironment,version:"2.0.0"};
